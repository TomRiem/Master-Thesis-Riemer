\section{Drift-Diffusion Equations on Metric Graphs}
\label{ch1:sec2}

In this section, we introduce a model that uses a set of differential equations defined on the edges of a metric graph to represent the traffic flow in a road network. We want to solve this model in an approximate way later in the thesis using various methods. \\
We imagine a compact road network, where we mean a finite number of finitely long roads connected by a finite number of junctions. We note that in a realistic road network there also exist roads which simply end, i.e. roads which end in an junction to which no other roads are connected, and there exist also one-way roads between two junctions. To model such a compact road network, we identify it with a compact directed metric graph $\Gamma = (\mathcal{V}, \mathcal{E})$, where obviously the roads are identified by edges $e \in \mathcal{E}$ and the junctions $v \in \mathcal{V}$ by vertices. The length $\ell_e > 0$ of each edge $e \in \mathcal{E}$ is either given by the length of the associated road or some other isometric representation of it. An example of such a compact road network is illustrated in Figure 1 and the associated graph is illustrated in Figure 2. \\

There exist several approaches to model the traffic flow on a road network. One of the most important approaches was presented in \cite{LighthillWhitham:1955} and independently in \cite{Richards:1956}, in which the traffic flow is described by equations describing the flow of water. These fluid dynamics equations are a set of partial differential equations known as the Navier-Stokes equations, which express the conservation of mass, momentum, and energy. The basic idea of this approach is to look at large scales so to consider individual cars as small particles and a set of cars as mass, and their density as the main quantity to be considered. The model in this thesis is inspired by the same idea, which is why we focus on the density of cars on an individual edge $e \in \mathcal{E}$, which we want to model with a function $\rho_e \colon (0, T) \times [0, \ell_e] \to [0, \rho_{e, max}]$, where $\rho_e (t,x)$ describes the density of cars at the time $t \in (0, T)$ at the coordinate $x \in [0, \ell_e]$ on the edge $e \in \mathcal{E}$. However, in many applications, the density is not allowed to exceed a maximal value $\rho_{e, max}$ (e.g. due to finite size effects), which should also be the case in this model, and we scale 

It is reasonable to assume the conservation of the number of cars, which can be expressed by a continuity equation for each individual edge $e \in \mathcal{E}$
\begin{equation}
    \label{continuity equation}
    \partial_t \rho_e (t,x) = - \partial_x J_e(t,x),
\end{equation}
where $J_e \colon (0,T) \times [0, \ell_e] \to \mathbb{R}$ is the flux of cars. \cref{continuity equation} describes the transport of a certain quantity of cars and expresses a relationship between the density of cars and the flux by linking the temporal change of the density to the spatial change of its flux density with the assumption of conservation of the number of cars. \\
Let the flux in the model in this thesis be given by 
\begin{equation} 
    \label{eq:flux} 
    J_e(t,x) \coloneqq - \varepsilon \partial_x \rho_e (t, x) + f(\rho_e(t, x)) \partial_x V_e(t, x).
\end{equation}
The flux is composed of two terms. The first term, $- \varepsilon \partial_x \rho_e (t, x)$, describes the transport by diffusion, which is given by Fick's first law, see \cite{Fick:1855}, where $\varepsilon > 0$ is the so-called diffusion coefficient. The second term, $f(\rho_e(t, x)) \partial_x V_e(t, x)$, describes the transport by flow, where $V_e \colon (0,T) \times [0, \ell_e] \to \mathbb{R}_{+}$ is a given potential, that may vary from edge to edge, and the function $f \colon \mathbb{R}_{+} \to \mathbb{R}_{+}$ is called mobility, satisfies $f(0) = f(\rho_{e, max}) = 0$ and its simplest choice is the so-called linear transport $f(\rho_e) = \mathrm{v} \cdot \rho_e$ with $\mathrm{v}$ the average velocity of cars. 

However, in many applications, the density is not allowed to exceed a maximal value (e.g. due to finite size effects). If this value is scaled to one, a choice of $f$ that obeys $f(1) = 0$ will ensure that solutions to \eqref{eq:Hamiltonian} will satisfy this bound for all times. A typical choice for $f$ will be $f(\rho_e) = \rho_e(1-\rho_e)$ in the following.



% 
%erster teil diffussion
%zweiter Teil transport
%Kirchhoff: alles was in den Knoten reinfließt muss auch rausfließen
% Kirchhoff: We note that the derivative is taken into the outgoing direction.
%operator nicht selbstadjungiert
% graph muss gerichtet sein, ansosnten erste ableitung nicht möglich
% initial conditions übernehmen
% Analytische Lösung nicht möglich
% 3.1.5 Lighthill-Whitham-Richards Model with Viscosity


\begin{equation} 
    \label{Drift-Diffusion-equation}
    \partial_t \rho_b (t,x) = \partial_x (\varepsilon \partial_x \rho_b (t,x) - f(\rho_b (t,x) ) \partial_x V_b (t,x)).
\end{equation}


The model is posed on a directed metric graph $\Gamma = (\mathcal{V}, \mathcal{E})$, where each edge $b \in \mathcal{E} = \mathcal{B}$ is equipped with a length $\ell_b > 0$ and a differential operator
\begin{equation} 
    \label{eq:Hamiltonian}
    \mathcal{H} [\rho_b] (t,x) \coloneqq \partial_t \rho_b (t,x)  - \partial_x (\varepsilon \partial_x \rho_b (t,x) + f(\rho_b (t,x) ) \partial_x V_b (t,x)).
\end{equation}
From now on we denote the ordered pair of vertices connected by a bond $b$ by $(v^{o}_b, v^{t}_b)$ and introduce a normal vector $n_b(v)$ to each bond defined via $n_b(v^{o}_b) = -1$ and $n_b(v^{t}_b) = 1$. Further we denote the edge set incident to a vertex $v \in \mathcal{V}$ by $\mathcal{E}_v$. In \cref{eq:Hamiltonian}, $\rho_e \colon (0,T) \times e \to \mathbb{R}_{+}$ describes, on each edge, the concentration of some quantity while $V_e \colon (0,T) \times e \to \mathbb{R}_{+}$ is a given potential, that may vary from edge to edge, and $\varepsilon > 0$ a given constant, typically small. The function $f \colon \mathbb{R}_{+} \to \mathbb{R}_{+}$ is called mobility, satisfies $f(0) = f(1) = 0$ and its simplest choice is $f(\rho_e) = \rho_e$, i.e. linear transport. However, in many applications, the density is now allowed to exceed a maximal value (e.g. due to finite size effects). If this value is scaled to one, a choice of $f$ that obeys $f(1) = 0$ will ensure that solutions to \eqref{eq:Hamiltonian} will satisfy this bound for all times. A typical choice for $f$ will be $f(\rho_e) = \rho_e(1-\rho_e)$ in the following. \\
To make \cref{eq:Hamiltonian} a well-posed problem, we need to add initial-conditions as well as coupling conditions on the vertices. On the set of interior vertices $v \in \mathcal{V}_\mathcal{K} \subset \mathcal{V}$, which are vertices that are incident to at least one incoming edge and at least one outgoing edge (i.e.$\forall v \in \mathcal{V}_\mathcal{K} \; \exists \ e_1, e_2 \in \mathcal{E}$ such that $v^{t}_{e_1} = v$ and $v^{o}_{e_2} = v$), we apply homogeneous Kirchhoff-Neumann coupling conditions, i.e., there holds
\begin{equation}
    \label{eq:Kirchhoff_Neumann_condition}
    \sum_{e\in \mathcal{E}_v} J_e(t,v) n_e (v)=0,
\end{equation}
where $J_e \colon (0,T) \times e \to \mathbb{R}$ is defined as the flux in a spatial point $x \in e$ via 
\begin{equation} 
    J_e(t,x) \coloneqq - \varepsilon \partial_x \rho_e (t, x) + f(\rho_e(t, x)) \partial_x V_e(t, x).
\end{equation}
Additionally, we ask the solution to be continuous on the set of interior vertices, i.e. 
\begin{equation}
    \label{continuous on vertices}
    \rho_e(v) = \rho_{e'}(v) \quad \text{ for all }v \in \mathcal{V}_\mathcal{K},\; e,\,e' \in \mathcal{E}_v
\end{equation}
with $\mathcal{E}_v$ the edge set incident to the vertex $v$. \\
On the set of exterior vertices $v \in \mathcal{V}_\mathcal{D} \coloneqq \mathcal{V} \setminus \mathcal{V}_\mathcal{K}$, which are vertices that are incident to either only one incoming edge or only one outgoing edge (i.e. $\forall v \in \mathcal{V}_\mathcal{D} \; \exists! \ e \in \mathcal{E}$ such that either $v^{t}_{e} = v$ or $v^{o}_{e} = v$), the solution $\rho$ should fulfills the flux boundary conditions
\begin{equation}
    \label{eq:Dirichlet_conditions}
    \sum_{e\in \mathcal{E}_v}J_e(v) n_e (v)=-\alpha_v(t) (1-\rho_v) + \beta_v(t) \rho_v,\ \text{for all}\ v \in \mathcal{V}_\mathcal{D}, e \in \mathcal{E}_v,
\end{equation}
where $\alpha_v \colon (0,T) \to \mathbb{R}_{+}, \, \beta_v \colon (0,T) \to \mathbb{R}_{+}$, ${v \in \mathcal{V}_\mathcal{D}}$ are functions prescribing the rate of influx of mass into the network ($\alpha_v$) as well as the velocity of mass leaving the network ($\beta_v$) at the boundary vertices. Note that this choice ensures that the bounds $0 \le \rho_e \le 1$ are preserved. In typical situations, boundary vertices are either of influx- or of outflux type, i.e. $\alpha_v \beta_v = 0$ for all $v \in \mathcal{V}_\mathcal{D}$. \\
The Kirchhoff-Neumann conditions are the natural boundary conditions for the differential operator \eqref{eq:Hamiltonian}, as they ensure that mass enters or leaves the system only via the boundary vertices $\mathcal{V}_\mathcal{D}$ for which either $\alpha_v$ or $\beta_v$ is positive. \\
Having introduced the complete continuous model, we state the following existence and uniqueness result. Details on the exact definition of the spaces and a sketch of the proof can be found in Section 

\begin{equation}
    \label{eq:initial_conditions}
    \rho_e(0,x) = \rho_{e, 0}(x) 
\end{equation}


\begin{theorem} 
    Given initial data $\rho_0 \in L^2(\Gamma)$ s.t. $0 \le \rho_0 \le 1$ a.e. on $\mathcal{E}$, there exists a unique weak solution $\rho \in L^2(0,T; H^1(\Gamma)) \cap H^1(0,T; (H^1)^*(\Gamma))$ s.t.
	\begin{align*}
		\sum_{e \in \mathcal{E}} \left(\int_e  \partial_t \rho_e \mathcal{V}arphi_e \;dx + \int_e \partial_x \rho_e\partial_x \mathcal{V}arphi_e \;dx\right) + \sum_{v \in \mathcal{V}_D} (-\alpha_v(t) (1-\rho_v) + \beta_v(t) \rho_v)\mathcal{V}arphi(v) = 0,
	\end{align*}
	for all testfunction $\mathcal{V}arphi \in H^1(\Gamma)$.
\end{theorem}

