\chapter{Different Approaches for Solving the Drift-Diffusion Equation on Metric Graphs using PINNs}

In this chapter we present different approaches of using a physics informed neural network to solve a set of drift-diffusion equations defined in a given metric graph to given initial and boundary conditions. These approaches will differ in their approach of learning of the used neural networks. In \cref{ch3:sec1}, we discuss a approach in which the drift-diffusion equations on all edges are considered simultaneously in the learning phase. That is, we combine the drift-diffusion equations on all edges of the graph and the associated initial and boundary conditions through a cleverly defined cost function and focus only on solving this single resulting cost function in the learning phase. In \cref{ch3:sec2}, we discuss an approach similar to the idea in \cite{JagtapKharazmiKarniadakis:2020}, where we define a cost function for each edge of the graph, optimize them one by one, store certain relevant data for the interconnection for each edge, and repeat this process several times. Thus, we have as many cost functions as edges of the graph, but in the learning phase they are minimized several times in succession. Nevertheless, in both approaches the same residual network is used for each edge, the approaches only differ in the cost function of the learning method, in which the corresponding neural network and the initial and boundary conditions enter in different ways, and the course of the learning phase, simultaneously or periodically. Furthermore, we use different types and topologies of neural networks for these two approaches. We perform numerical experiments for each combination of PINN approach and neural network and compare the solutions with those generated by the FEM presented in \cref{ch2}. We are particularly interested in the accuracy and efficiency of the different approaches so that we can determine a superior method for solving the differential equation. Finally, in \cref{ch3:sec3}, we compare the performance of a PINN with explicitly calculated derivatives used inside the Hamiltonian, and thus in the corresponding residual network and cost function, with that of a PINN that uses automatic differentiation for this purpose, in order to demonstrate the capabilities of \lstinline!TensorFlow!. \\
In order to compare all the results of all numerical experiments, the set of drift-diffusion equations is considered on the same metric graph $\Gamma$ under the same initial and boundary conditions in each experiment. The graph $\Gamma = (\mathcal{V}, \mathcal{E})$ given by the following adjacency matrix: 
\begin{equation*}
    A^{\Gamma} = 
    \begin{blockarray}{ccccccc}
        v_1 & v_2 & v_3 & v_4 & v_5 & v_6 \\
        \begin{block}{(cccccc)c}
            0 & 0 & 1 & 0 & 0 & 0 & v_1 \\
            0 & 0 & 1 & 0 & 0 & 0 & v_2 \\
            0 & 0 & 0 & 1 & 0 & 0 & v_3 \\
            0 & 0 & 0 & 0 & 1 & 1 & v_4 \\
            0 & 0 & 0 & 0 & 0 & 0 & v_5 \\
            0 & 0 & 0 & 0 & 0 & 0 & v_6 \\
        \end{block}
    \end{blockarray}
\end{equation*}
The graph $\Gamma$ consists of $6$ vertices $\mathcal{V} = \{ v_i \}_{i = 1,\ldots, 6}$ and $5$ edges $\mathcal{E} = \{ e_i \}_{i = 1,\ldots, 5}$  and is of course directed since $A^{\Gamma}$ is not symmetric. The graph $\Gamma$ is illustrated in \cref{fig7}. 
\begin{figure}[H]
    \begin{center}
        \begin{tikzpicture}
            % vertices
            \node[shape=circle,draw=black] (v1) at (-2.4,1.4) {$v_1$};
            \node[shape=circle,draw=black] (v5) at (2.4,1.4) {$v_5$};
            \node[shape=circle,draw=black] (v3) at (-1,0) {$v_3$};
            \node[shape=circle,draw=black] (v4) at (1,0) {$v_4$};
            \node[shape=circle,draw=black] (v2) at (-2.4,-1.4) {$v_2$};
            \node[shape=circle,draw=black] (v6) at (2.4,-1.4) {$v_6$};
            
            % edges
            \path [->](v1) edge node[above] {$e_1$} (v3);
            \path [->](v2) edge node[below] {$e_2$} (v3);
            \path [->](v3) edge node[above] {$e_3$} (v4);
            \path [->](v4) edge node[above] {$e_4$} (v5);
            \path [->](v4) edge node[below] {$e_5$} (v6);
        \end{tikzpicture}
    \end{center}
    \caption{Will come soon \ldots}
    \label{fig7}
\end{figure}
As we can see, the vertices $v_1$, $v_2$, $v_5$ and $v_6$ are exterior vertices and the vertices $v_3$ and $v_4$ are interior vertices. We further assume that the graph $\Gamma$ is equilateral (see \cref{metric graph equilateral}) with $\ell = 1$. \\
We consider on each individual edge $e \in \mathcal{E}$ the drift-diffusion equation given by \cref{Drift-Diffusion-equation} for $x \in [0,1]$ and on the time interval $t \in (0, 10)$, where we set $\varepsilon = 0.01$, the mobility is given by $f(\rho_e(t,x)) = \rho_e (t,x)(1-\rho_e (t,x))$ and we assume that $\partial_x V_b (t,x) = 1$ for all $(t,x) \in (0, 10) \times [0,1]$ holds. On the exterior vertices $\mathcal{V}_{\mathcal{D}} = \{v_1, v_2, v_5, v_6 \}$, we have for flux boundary conditions, \cref{eq:Dirichlet_conditions}, constant influx rates which are specified for $v_1$ by $\alpha_{v_1}(t) = 0.9$ and $\beta_{v_1}(t) = 0$, for $v_2$ by $\alpha_{v_2}(t) = 0.3$ and $\beta_{v_2}(t) = 0$, for $v_5$ by $\alpha_{v_5}(t) = 0$ and $\beta_{v_5}(t) = 0.8$ and for $v_6$ by $\alpha_{v_6}(t) = 0$ and $\beta_{v_6}(t) = 0.1$. 



The numerical experiments are implemented in the toolbox \lstinline!Manopt.jl!. They were run on a Lenovo ThinkPad L490, 64 bit Windows system, 1.8 Ghz Intel Core i7-8565U, 32 GB RAM, with Julia 1.5.2.

\input{Chapter3/OneNN.tex}
\input{Chapter3/EdgeNN.tex}
\input{Chapter3/ADvsExplicit.tex}